{"name": "TC_010: High cart value with FLAT% offer", "status": "failed", "statusDetails": {"message": "AssertionError: Expected 4999.5, got 9989\nassert 9989 == 4999.5\n +  where 9989 = round(9989, 2)\n +  and   4999.5 = round(4999.5, 2)", "trace": "cart_offer = <library.services.cart_offer_services.CartOfferServices object at 0x76d74eb93980>\nmockserver = <library.mockserver.MockServer object at 0x76d74e9dc410>, title = 'TC_010: High cart value with FLAT% offer'\nuser_id = 1, segment = 'p1', offer_type = 'FLAT%', offer_value = 50, cart_value = 9999, expected_cart_value = 4999.5\nxfail_reason = None\n\n    @allure.feature(\"Cart Offer - Flat Discount Logic (FLATX and FLAT%)\")\n    @pytest.mark.cart\n    @pytest.mark.parametrize(\n        \"title, user_id, segment, offer_type, offer_value, cart_value, expected_cart_value, xfail_reason\",\n        [\n            (\"TC_001: FLATX offer applied correctly\", 1, \"p1\", \"FLATX\", 10, 200, 190, None),\n            (\"TC_002: FLATX offer with high discount (but valid)\", 1, \"p1\", \"FLATX\", 40, 200, 160, None),\n            (\"TC_003: FLAT% offer applied correctly\", 2, \"p2\", \"FLAT%\", 10, 200, 180, None),\n            (\"TC_004: FLATX equals cart value\", 1, \"p1\", \"FLATX\", 100, 100, 0, None),\n            (\"TC_005: FLATX exceeds cart value\", 1, \"p1\", \"FLATX\", 200, 50, 0, None),\n            (\"TC_006: FLAT% with 100% discount\", 3, \"p3\", \"FLAT%\", 100, 200, 0, None),\n            (\"TC_007: FLAT% with >100% discount\", 3, \"p3\", \"FLAT%\", 150, 200, 0, None),\n            (\"TC_008: Zero cart value with FLATX\", 2, \"p2\", \"FLATX\", 10, 0, 0, None),\n            (\"TC_009: Decimal cart value with FLATX\", 1, \"p1\", \"FLATX\", 10, 199.99, 189.99, None),\n            (\"TC_010: High cart value with FLAT% offer\", 1, \"p1\", \"FLAT%\", 50, 9999, 4999.5, None),\n        ]\n    )\n    def test_cart_offer_flat_cases(\n        cart_offer: CartOfferServices,\n        mockserver: MockServer,\n        title: str,\n        user_id: int,\n        segment: str,\n        offer_type: str,\n        offer_value: float,\n        cart_value: float,\n        expected_cart_value: float,\n        xfail_reason: str\n    ):\n        allure.dynamic.title(title)\n    \n        if xfail_reason:\n            pytest.xfail(reason=xfail_reason)\n    \n        mockserver.set_user_segment_mock(user_id=user_id, segment=segment)\n    \n        cart_offer.create_offer(\n            restaurant_id=1,\n            offer_type=offer_type,\n            offer_value=offer_value,\n            customer_segment=[segment]\n        )\n    \n        response = cart_offer.apply_offer(\n            cart_value=cart_value,\n            user_id=user_id,\n            restaurant_id=1\n        )\n    \n        actual_cart_value = response.json()[\"cart_value\"]\n    \n        if isinstance(expected_cart_value, float):\n>           assert round(actual_cart_value, 2) == round(expected_cart_value, 2), f\"Expected {expected_cart_value}, got {actual_cart_value}\"\nE           AssertionError: Expected 4999.5, got 9989\nE           assert 9989 == 4999.5\nE            +  where 9989 = round(9989, 2)\nE            +  and   4999.5 = round(4999.5, 2)\n\ntests/test_discount_logic.py:59: AssertionError"}, "attachments": [{"name": "log", "source": "3cf3489f-317d-4c39-b77a-74d54dcdb4ac-attachment.txt", "type": "text/plain"}], "parameters": [{"name": "title", "value": "'TC_010: High cart value with FLAT% offer'"}, {"name": "user_id", "value": "1"}, {"name": "segment", "value": "'p1'"}, {"name": "offer_type", "value": "'FLAT%'"}, {"name": "offer_value", "value": "50"}, {"name": "cart_value", "value": "9999"}, {"name": "expected_cart_value", "value": "4999.5"}, {"name": "xfail_reason", "value": "None"}], "start": 1752147998451, "stop": 1752147998478, "uuid": "c02ad1d4-2866-4f39-b04a-7b868e66c284", "historyId": "b2af8e47a18562ba7302f32c9beb1c1a", "testCaseId": "9170716926feaeb6390f1a985ad51cb2", "fullName": "tests.test_discount_logic#test_cart_offer_flat_cases", "labels": [{"name": "feature", "value": "Cart Offer - Flat Discount Logic (FLATX and FLAT%)"}, {"name": "tag", "value": "cart"}, {"name": "parentSuite", "value": "tests"}, {"name": "suite", "value": "test_discount_logic"}, {"name": "host", "value": "LAPTOP-AEEGI4HU"}, {"name": "thread", "value": "143636-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "tests.test_discount_logic"}]}